---
title: "Avaliação de indicadores de práticas de saúde"
output:
  html_document:
    toc: yes
    encoding: UTF-8
---

# 1 Introdução

# 2 Objetivo

::: {align="justify"}
O presente estudo possui o objetivo de verificar a relação entre os indicadores socioeconômicos com indicadores sínteses de práticas de saúde .
:::

# 3 Referencial Teórico

# 3.1 Estudos indicadores de práticas de saúde

# 4 Metodologia

::: {align="justify"}
O presente estudo possui uma abordagem de pesquisa quantitativa e, em relação a seu objetivo, esta pesquisa possui um perfil exploratório, uma vez que apresentará o resultado da análise quantitativa da relação dos indicadores socioeconômicos com os indicadores síntese de práticas de saúde.
:::

::: {align="justify"}
Os dados socioeconômicos tiveram como período de referência o ano de 2023 e foram coletados por meio do pacote `ipeadataR` e importados para o RStudio. Foram coletadas as seguintes variáveis:
:::

::: {align="justify"}
-   IDHM (Estados, Municípios, Regional e Federal);
-   PIB a preços de mercado (Estados, Municípios, Regional e Federal);
-   Índice de Gini (Estados, Municípios, Regional e Federal);
-   Índice de Vulnerabilidade Social (Estados, Municípios, Regional e Federal).
:::

::: {align="justify"}
No que diz respeito aos indicadores síntese de práticas de saúde, foram coletados a partir dos dados disponibilizados pela Secretaria de Atenção Primária à Saúde (SAPS/MS) em relação ao ano de 2023, conforme descrição abaixo:
:::

**Tabela 1 – Variáveis analisadas**

| Grupo                   | Variável                                              |
|----------------------|--------------------------------------------------|
| Temas de saúde          | Saúde bucal                                           |
| Temas de saúde          | Alimentação saudável                                  |
| Temas de saúde          | Saúde sexual e reprodutiva                            |
| Temas de saúde          | Saúde mental                                          |
| Temas de saúde          | Autocuidado de pessoas com doenças crônicas           |
| Práticas de saúde       | Antropometria                                         |
| Práticas de saúde       | Práticas corporais/atividade física                   |
| Práticas de saúde       | Verificação da saúde vacinal                          |
| Prog. saúde nas escolas | Educação                                              |
| Prog. saúde nas escolas | Saúde                                                 |
| Bolsa Família           | Percentual de cobertura de beneficiários acompanhados |

*Fonte: Elaboração própria*

::: {style="text-align: justify; text-indent: 2em;"}
Os indicadores foram construídos com base em proporções relativas a diferentes contextos. No que diz respeito aos indicadores de práticas e temas de saúde, considerou-se a razão entre a quantidade de práticas de saúde e a população cadastrada pelo IBGE.
:::

::: {style="text-align: justify; text-indent: 2em;"}
No que tange aos indicadores do Programa Saúde nas Escolas, adotou-se a razão entre a quantidade de práticas de saúde nas escolas e o quantitativo de estabelecimentos de ensino participantes do programa.
:::

::: {style="text-align: justify; text-indent: 2em;"}
Por fim, sobre a variável de percentual de cobertura de beneficiários acompanhados pelo Bolsa Família, como o dado já está padronizado em percentual, considerou-se que a avaliação em relação aos indicadores socioeconômicos será direta.
:::

```{r, warning=FALSE, message=FALSE, echo = FALSE}
library(openxlsx)
library(kableExtra)
library(xlsx)
library(tidyverse)
library(ggplot2)
library(sf)
library(readxl)
library(scales)
library(ggplot2)
library(scales)
library(scales)

options(scipen = 99999)

```

```{r, echo=FALSE}
pop_cad_2023 <- read.xlsx("DadosAtividadesePop/grupos 1 e 2 População Cadastrada/pop_cadastrada_2023.xls", sheetName = 'BRASIL')

pse_2023 <- read.xlsx('DadosAtividadesePop/Saúde na Escola/Produção do PSE/producao_pse_2023.xlsx', sheetName = 'Dados', startRow = 10, endRow = 5370)

prom_saude_2023 <- read.xlsx('DadosAtividadesePop/grupo 2 Práticas para a Saúde/praticas2023.xlsx', sheetName = 'Dados', startRow = 12, endRow = 5372)

temas_saude_2023 <- read.xlsx('DadosAtividadesePop/grupo 1 Temas para a Saúde/temas2023.xlsx', sheetName = 'Dados', startRow = 12, endRow = 5442)

escolas_adesao_2023_2024 <- read_excel("DadosAtividadesePop/Saúde na Escola/Escolas com Adesão - Denominador/escolas_adesao_2023_2024.xlsx", sheet = "ADESÕES", skip = 5)

Bolsa_familia_2023 <- read.xlsx('DadosAtividadesePop/Bolsa Família/Bfa_Consolidado-geral-22023-porMunicipio.xlsx', sheetName = 'Bfa_Consolidado-geral-22023-por', startRow = 8, endRow = 5578)
```

```{r, echo=FALSE}
### Tratamento de dados ###

prom_saude_2023 <- prom_saude_2023 %>%
  rename('IBGE' = 'Ibge',
        'Praticas_atividades_corporais' = 'Práticas.corporais...atividade',
        'Verific_sit_vacina' = 'Verificação.da.situação.vacina')

pop_cad_2023 <- pop_cad_2023%>%
  rename('POP_CADASTRADA_IBGE' = 'Qt..Total.de.cadastros...limitado.pela.população.IBGE.',
         'Regiao' = 'Região')

pop_cad_2023 <- pop_cad_2023 %>%
  filter(POP_CADASTRADA_IBGE > 0)

pse_2023 <- pse_2023 %>%
  rename('IBGE' = 'Ibge')

temas_saude_2023 <- temas_saude_2023 %>%
  rename('IBGE' = 'Ibge',
         'auto_cuid_doenc_cronic' = 'Autocuidado.de.pessoas.com.doe',
         'Saude_reprodut' = 'Saúde.sexual.e.reprodutiva',
         'Saude_bucal' = 'Saúde.bucal',
         'Aliment_saudav' = 'Alimentação.saudável',
         'Saude_mental' = 'Saúde.mental')

Bolsa_familia_2023 <- Bolsa_familia_2023 %>%
  rename('perc_cob_ben_acomp' = 'Perc..cobertura.de.beneficiários.acompanhados....',
         'UF_SIGLA' = 'Estado')

```

```{r, echo=FALSE}

# Tratamento dados - Temas de saúde 

temas_saude_2023 <- temas_saude_2023%>%
  rename('UF_SIGLA' = 'Uf')%>%
  mutate(Municipio_UF = str_c(Municipio, UF_SIGLA, sep = " - "))%>%
  select('IBGE', 'UF_SIGLA', 'Municipio_UF', 'Saude_bucal', 'Aliment_saudav',
         'Saude_reprodut', 'Saude_mental', 'auto_cuid_doenc_cronic')

base_temas_saude_2023 <- merge(pop_cad_2023, temas_saude_2023, by = "IBGE")
```

```{r, echo=FALSE}

base_temas_saude_2023 <- base_temas_saude_2023 %>%
  mutate(across(
    c(
      IBGE,
      População,
      POP_CADASTRADA_IBGE,
      Cobertura.APS,
      Saude_bucal,
      Aliment_saudav,
      Saude_reprodut,
      Saude_mental,
      auto_cuid_doenc_cronic),
    as.numeric))

base_temas_saude_2023 <- base_temas_saude_2023%>%
  mutate(Saude_bucal = round(Saude_bucal,0),
         Aliment_saudav = round(Aliment_saudav,0),
         Saude_reprodut = round(Saude_reprodut,0),
         Saude_mental = round(Saude_mental,0),
         auto_cuid_doenc_cronic = round(auto_cuid_doenc_cronic,0),)

```

```{r, echo=FALSE}

# Tratamento dados - Práticas de promoção a saúde

base_pratic_saude_2023 <- merge(pop_cad_2023, prom_saude_2023, by = "IBGE")

base_pratic_saude_2023 <- base_pratic_saude_2023 %>%
    mutate(UF_SIGLA = case_when(
    UF == 'ACRE' ~ "AC",
    UF == 'ALAGOAS' ~ "AL",
    UF == 'AMAPA' ~ "AP",
    UF == 'AMAZONAS' ~ "AM",
    UF == 'BAHIA' ~ "BA",
    UF == 'CEARA' ~ "CE",
    UF == 'DISTRITO FEDERAL' ~ "DF",
    UF == 'ESPIRITO SANTO' ~ "ES",
    UF == 'GOIAS' ~ "GO",
    UF == 'MARANHAO' ~ "MA",
    UF == 'MATO GROSSO' ~ "MT",
    UF == 'MATO GROSSO DO SUL' ~ "MS",
    UF == 'MINAS GERAIS' ~ "MG",
    UF == 'PARA' ~ "PA",
    UF == 'PARAIBA' ~ "PB",
    UF == 'PARANA' ~ "PR",
    UF == 'PERNAMBUCO' ~ "PE",
    UF == 'PIAUI' ~ "PI",
    UF == 'RIO DE JANEIRO' ~ "RJ",
    UF == 'RIO GRANDE DO NORTE' ~ "RN",
    UF == 'RIO GRANDE DO SUL' ~ "RS",
    UF == 'RONDONIA' ~ "RO",
    UF == 'RORAIMA' ~ "RR",
    UF == 'SANTA CATARINA' ~ "SC",
    UF == 'SAO PAULO' ~ "SP",
    UF == 'SERGIPE' ~ "SE",
    UF == 'TOCANTINS' ~ "TO",
    TRUE ~ NA_character_
  ))

base_pratic_saude_2023 <- base_pratic_saude_2023 %>%
  mutate(Municipio_UF = str_c(Município, UF_SIGLA, sep = " - ")) %>%
  select('Regiao', 'UF', 'UF_SIGLA', 'IBGE', 'Município', 'Municipio_UF', 'População', 'POP_CADASTRADA_IBGE', 'Cobertura.APS', 'Antropometria', 
         'Praticas_atividades_corporais',
         'Verific_sit_vacina')

base_pratic_saude_2023 <- base_pratic_saude_2023 %>%
  mutate(across(
    c(IBGE,
      População,
      POP_CADASTRADA_IBGE,
      Cobertura.APS,
      Antropometria, 
      Praticas_atividades_corporais,
      Verific_sit_vacina),
        as.numeric))

base_pratic_saude_2023 <- base_pratic_saude_2023%>%
  mutate(Antropometria = round(Antropometria,0),
         Praticas_atividades_corporais = round(Praticas_atividades_corporais,0),
         Verific_sit_vacina = round(Verific_sit_vacina,0))

```

```{r, echo=FALSE, warning=FALSE, message = FALSE}

group_esc_adesao_2023_2024 <- escolas_adesao_2023_2024%>%
  mutate(Municipio_UF = str_c(MUNICÍPIO, UF, sep = " - ")) %>%
  select('UF',	'MUNICÍPIO', 'Municipio_UF', 'IBGE', 'CICLO', 'TIPO DE LOCALIZACAÇÃO',	
  'LOCALIZAÇÃO DIFERENCIADA', 'ESFERA ADMINISTRATIVA', 'NOME DA ESCOLA')

group_esc_adesao_2023_2024 <- escolas_adesao_2023_2024%>%
  group_by(IBGE, MUNICÍPIO, UF) %>%
  summarise(QTD_escolas = n()) %>%
  ungroup()

base_adesão_escolas_pse_2023 <- merge(group_esc_adesao_2023_2024, pse_2023, by = "IBGE")

base_adesão_escolas_pse_2023 <- base_adesão_escolas_pse_2023%>%
    mutate(Municipio_UF = str_c(MUNICÍPIO, UF, sep = " - ")) %>%
    select('IBGE', 'MUNICÍPIO', 'Municipio_UF', 'UF', 'QTD_escolas', 'Educação', 'Saúde')

base_adesão_escolas_pse_2023 <- base_adesão_escolas_pse_2023 %>%
    mutate(Regiao = case_when(
    UF == 'AC' ~ "NORTE",
    UF == 'AL' ~ "NORDESTE",
    UF == 'AP' ~ "NORTE",
    UF == 'AM' ~ "NORTE",
    UF == 'BA' ~ "NORDESTE",
    UF == 'CE' ~ "NORDESTE",
    UF == 'DF' ~ "CENTRO - OESTE",
    UF == 'ES' ~ "SUDESTE",
    UF == 'GO' ~ "CENTRO - OESTE",
    UF == 'MA' ~ "NORDESTE",
    UF == 'MT' ~ "CENTRO - OESTE",
    UF == 'MS' ~ "CENTRO - OESTE",
    UF == 'MG' ~ "SUDESTE",
    UF == 'PA' ~ "NORTE",
    UF == 'PB' ~ "NORDESTE",
    UF == 'PR' ~ "SUL",
    UF == 'PE' ~ "NORDESTE",
    UF == 'PI' ~ "NORDESTE",
    UF == 'RJ' ~ "SUDESTE",
    UF == 'RN' ~ "NORDESTE",
    UF == 'RS' ~ "SUL",
    UF == 'RO' ~ "NORTE",
    UF == 'RR' ~ "NORTE",
    UF == 'SC' ~ "SUL",
    UF == 'SP' ~ "SUDESTE",
    UF == 'SE' ~ "NORDESTE",
    UF == 'TO' ~ "NORTE",
    TRUE ~ NA_character_
  ))


base_adesão_escolas_pse_2023 <- base_adesão_escolas_pse_2023 %>%
  mutate(across(
    c(IBGE,
      Educação,
      Saúde),
    as.numeric
  ))

```

```{r, echo=FALSE}

# Tratamento dados - Bolsa Família

Bolsa_familia_2023 <- Bolsa_familia_2023%>%
  mutate(Regiao = case_when(
    UF_SIGLA == 'AC' ~ "NORTE",
    UF_SIGLA == 'AL' ~ "NORDESTE",
    UF_SIGLA == 'AP' ~ "NORTE",
    UF_SIGLA == 'AM' ~ "NORTE",
    UF_SIGLA == 'BA' ~ "NORDESTE",
    UF_SIGLA == 'CE' ~ "NORDESTE",
    UF_SIGLA == 'DF' ~ "CENTRO - OESTE",
    UF_SIGLA == 'ES' ~ "SUDESTE",
    UF_SIGLA == 'GO' ~ "CENTRO - OESTE",
    UF_SIGLA == 'MA' ~ "NORDESTE",
    UF_SIGLA == 'MT' ~ "CENTRO - OESTE",
    UF_SIGLA == 'MS' ~ "CENTRO - OESTE",
    UF_SIGLA == 'MG' ~ "SUDESTE",
    UF_SIGLA == 'PA' ~ "NORTE",
    UF_SIGLA == 'PB' ~ "NORDESTE",
    UF_SIGLA == 'PR' ~ "SUL",
    UF_SIGLA == 'PE' ~ "NORDESTE",
    UF_SIGLA == 'PI' ~ "NORDESTE",
    UF_SIGLA == 'RJ' ~ "SUDESTE",
    UF_SIGLA == 'RN' ~ "NORDESTE",
    UF_SIGLA == 'RS' ~ "SUL",
    UF_SIGLA == 'RO' ~ "NORTE",
    UF_SIGLA == 'RR' ~ "NORTE",
    UF_SIGLA == 'SC' ~ "SUL",
    UF_SIGLA == 'SP' ~ "SUDESTE",
    UF_SIGLA == 'SE' ~ "NORDESTE",
    UF_SIGLA == 'TO' ~ "NORTE",
    TRUE ~ NA_character_))

#base_temas_saude_2023 <- merge(pop_cad_2023, temas_saude_2023, by = "IBGE")
```

```{r, echo=FALSE}

# Apuração Indicadores - Temas Saúde

ind_temas_saude <- base_temas_saude_2023 %>%
  mutate(ind_saude_bucal = if_else(POP_CADASTRADA_IBGE == 0, NA_real_, (Saude_bucal / POP_CADASTRADA_IBGE) * 100000),
    ind_Aliment_saudav = if_else(POP_CADASTRADA_IBGE == 0, NA_real_, (Aliment_saudav / POP_CADASTRADA_IBGE) * 100000),
    ind_Saude_reprodut = if_else(POP_CADASTRADA_IBGE == 0, NA_real_, (Saude_reprodut / POP_CADASTRADA_IBGE) * 100000),
    ind_Saude_mental = if_else(POP_CADASTRADA_IBGE == 0, NA_real_, (Saude_mental / POP_CADASTRADA_IBGE) * 100000),
    ind_auto_cuid_doenc_cronic = if_else(POP_CADASTRADA_IBGE == 0, NA_real_, (auto_cuid_doenc_cronic / POP_CADASTRADA_IBGE) * 100000)
  ) %>%
  select(UF, IBGE, Município, Regiao, Municipio_UF,ind_saude_bucal, ind_Aliment_saudav, ind_Saude_reprodut,ind_Saude_mental, ind_auto_cuid_doenc_cronic, Saude_bucal,
Aliment_saudav, Saude_reprodut, Saude_mental, auto_cuid_doenc_cronic,
POP_CADASTRADA_IBGE)
```

```{r, echo=FALSE}

# Considerando todas as cidades pop = 0 - Apuração Indicadores

ind_temas_saude <- base_temas_saude_2023 %>%
  mutate(ind_saude_bucal = ((Saude_bucal / POP_CADASTRADA_IBGE) * 100000),
        ind_Aliment_saudav = ((Aliment_saudav / POP_CADASTRADA_IBGE) * 100000),
        ind_Saude_reprodut = ((Saude_reprodut / POP_CADASTRADA_IBGE) * 100000),
        ind_Saude_mental = ((Saude_mental / POP_CADASTRADA_IBGE) * 100000),
        ind_auto_cuid_doenc_cronic = ((auto_cuid_doenc_cronic  / POP_CADASTRADA_IBGE) * 100000)
  ) %>%
  select(UF, IBGE, Município, Municipio_UF, Regiao, ind_saude_bucal, ind_Aliment_saudav, ind_Saude_reprodut, ind_Saude_mental, ind_auto_cuid_doenc_cronic, Saude_bucal,
Aliment_saudav, Saude_reprodut, Saude_mental, auto_cuid_doenc_cronic,
POP_CADASTRADA_IBGE)
```

```{r, echo=FALSE}

# Apuração Indicadores - Práticas de Saúde

ind_praticas_saude <- base_pratic_saude_2023 %>%
  mutate(ind_Antropometria = ((Antropometria / POP_CADASTRADA_IBGE) * 100000),
        ind_Praticas_atividades_corporais = ((Praticas_atividades_corporais / POP_CADASTRADA_IBGE) * 100000),
        ind_Verific_sit_vacina = ((Verific_sit_vacina / POP_CADASTRADA_IBGE) * 100000))%>%
  select(UF, IBGE, Município, Municipio_UF, Regiao, ind_Antropometria, ind_Praticas_atividades_corporais, ind_Verific_sit_vacina, Antropometria, Praticas_atividades_corporais, Verific_sit_vacina, POP_CADASTRADA_IBGE)

```

```{r, echo=FALSE}

# Apuração Indicadores - Adesão Escolas

ind_adesão_escolas <- base_adesão_escolas_pse_2023 %>%
  mutate(ind_Educação = Educação / QTD_escolas,
         ind_Saúde = Saúde / QTD_escolas)%>%
  select(UF, IBGE, MUNICÍPIO, Municipio_UF, QTD_escolas, Regiao, ind_Educação, Educação, Saúde, ind_Saúde)
```

# 5 Análise de Resultados

# 5.1 Tabela indicadores de saúde bucal {.tabset}

::: {style="text-align: justify; text-indent: 2em;"}
Os dados evidenciam uma dispersão elevada e constatou-se uma forte concentração de referente ao número de práticas de educação e saúde nas escolas em valores próximos a zero, sendo que este comportamento ocorreu no âmbito estadual, regional e federal. Além disso, constatou-se a ocorrência de outliers, na série, ou seja, municípios que apresentaram uma elevada quantidade de práticas de saúde e educação em comparação a outras cidades.
:::

::: {style="text-align: justify; text-indent: 2em;"}
Em relação as métricas utilizadas, a variável “indicador” é representada pelo somatório das práticas de saúde e educação dividida pelo total de escolas da UF e/ou Regiao. Em relação a “taxa média”, ela é obtida por meio das taxas de práticas de saúde e educação dos municípios dividido pela quantidade de municípios por UF e Regiao.
:::

::: {style="text-align: justify; text-indent: 2em;"}
Portanto, diante da alta volatilidade, assimetria dos resultados e presença de outliers, rejeita-se a adoção da premissa de normalidade das séries. Esta conclusão é reforçada pelos resultados dos testes de Shapiro-wilk, que, em todos as instâncias analisadas (estadual, regional e federal), não se verificou que o que o resultado do teste foi superior ao nível de significância adotado (5%).
:::

## Dados por UF

```{r, echo=FALSE, warning=FALSE}

kable(ind_temas_saude%>%
  group_by(UF) %>%
  summarise(Regiao = first(Regiao),
    indicador = round((sum(Saude_bucal) / sum(POP_CADASTRADA_IBGE))*100000,2),
    media = round(mean(ind_saude_bucal, na.rm = TRUE),2),
    mediana = round(median(ind_saude_bucal, na.rm = TRUE),2),
    desvio_padrao = round(sd(ind_saude_bucal, na.rm = TRUE),2),
    minimo = round(min(ind_saude_bucal, na.rm = TRUE),2),
    maximo = round(max(ind_saude_bucal, na.rm = TRUE),2),
    pvalor_shapiro = ifelse(sum(!is.na(ind_saude_bucal)) >= 3,
      round(tryCatch(shapiro.test(ind_saude_bucal)$p.value, error = function(e) NA), 5),NA),
    Numerador = sum(Saude_bucal),
    Denominador = sum(POP_CADASTRADA_IBGE),
    n_municip = n())%>%
  arrange(Regiao, UF)) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"), font_size = 10)%>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de praticas adotadas (por UF, Regiao ou país) pela coluna de total de população cadastrada no IBGE.")

```

## Dados por Regiao

```{r, echo=FALSE, warning=FALSE}

kable(ind_temas_saude%>%
  group_by(Regiao) %>%
  summarise(indicador = round((sum(Saude_bucal) / sum(POP_CADASTRADA_IBGE))*100000,2),
    media = round(mean(ind_saude_bucal, na.rm = TRUE),2),
    mediana = round(median(ind_saude_bucal, na.rm = TRUE),2),
    desvio_padrao = round(sd(ind_saude_bucal, na.rm = TRUE),2),
    minimo = round(min(ind_saude_bucal, na.rm = TRUE),2),
    maximo = round(max(ind_saude_bucal, na.rm = TRUE),2),
    pvalor_shapiro = ifelse(sum(!is.na(ind_saude_bucal)) >= 3,
      round(tryCatch(shapiro.test(ind_saude_bucal)$p.value, error = function(e) NA), 5),NA),
    Numerador = sum(Saude_bucal),
    Denominador = sum(POP_CADASTRADA_IBGE),
    n_municip = n())%>%
  arrange(Regiao)) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"), font_size = 10)%>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de praticas adotadas (por UF, Regiao ou país) pela coluna de total de população cadastrada no IBGE.")

```

## Dados Nacionais

```{r, echo=FALSE, warning=FALSE}
ind_temas_saude %>%
  summarise(
    Pais = 'Brasil',
    Indicador = round((sum(Saude_bucal) / sum(POP_CADASTRADA_IBGE)) * 100000, 2),
    Media = round(mean(ind_saude_bucal, na.rm = TRUE), 2),
    Mediana = round(median(ind_saude_bucal, na.rm = TRUE), 2),
    Desvio_padrao = round(sd(ind_saude_bucal, na.rm = TRUE), 2),
    Min = round(min(ind_saude_bucal, na.rm = TRUE), 2),
    Max = round(max(ind_saude_bucal, na.rm = TRUE), 2),
    Pvalor_shapiro = ifelse(
      sum(!is.na(ind_saude_bucal)) >= 3,
      round(tryCatch(shapiro.test(ind_saude_bucal)$p.value, error = function(e) NA), 5),
      NA
    ),
    Numerador = sum(Saude_bucal),
    Denominador = sum(POP_CADASTRADA_IBGE),
    n_municip = n()
  ) %>%
  kable(format = "html") %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(
    general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela população cadastrada segundo o IBGE."
  )

```

## Gráficos

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, fig.height=4}
ggplot(ind_temas_saude,
       aes(x = ind_saude_bucal, fill = Regiao)) +
  geom_histogram(alpha = 0.5, bins = 40, position = "identity") +
  labs(x = "Prática de saúde bucal por 100 mil habitantes",
     y = "Número de municípios") +
  theme_minimal()+
  theme(
    legend.position = "bottom",
    legend.box = "horizontal",
    legend.title = element_blank()
    )
```

```{r, echo=FALSE, fig.width=8, fig.height=4}
ggplot(ind_temas_saude, aes(y = ind_saude_bucal, fill = Regiao)) +
geom_boxplot() +
labs(
  title = "Indicador Saúde Bucal - Por Regiões", 
  subtitle = "Ano: 2023", 
  caption = "Fonte: Ministério da Saúde"
) +
theme_bw() +
theme(
  plot.title = element_text(size = 12, face = "bold"),
  plot.subtitle = element_text(size = 10),
  legend.position = "bottom",
  legend.title = element_blank()

)
```

# 5.2 Indicadores de saúde mental {.tabset}

## Dados por UF

```{r, echo=FALSE, warning=FALSE}

kable(ind_temas_saude%>%
  group_by(UF) %>%
  summarise(Regiao = first(Regiao),
    Indicador = round((sum(Saude_mental) / sum(POP_CADASTRADA_IBGE))*100000,2),
    Media = round(mean(ind_Saude_mental, na.rm = TRUE),2),
    Mediana = round(median(ind_Saude_mental, na.rm = TRUE),2),
    Desvio_pad = round(sd(ind_Saude_mental, na.rm = TRUE),2),
    Minimo = round(min(ind_Saude_mental, na.rm = TRUE),2),
    Maximo = round(max(ind_Saude_mental, na.rm = TRUE),2),
    Pvalor_shapiro = ifelse(sum(!is.na(ind_Saude_mental)) >= 3,
      round(tryCatch(shapiro.test(ind_Saude_mental)$p.value, error = function(e) NA), 5),NA),
    Numerador = sum(Saude_mental),
    Denominador = sum(POP_CADASTRADA_IBGE),
    n_municip = n())%>%
  arrange(Regiao, UF)) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"), font_size = 10)%>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de praticas adotadas (por UF, Regiao ou país) pela coluna de total de população cadastrada no IBGE.")

```

## Dados por Regiao

```{r, echo=FALSE, warning=FALSE}

kable(
  ind_temas_saude %>%
    group_by(Regiao) %>%
    summarise(
      Indicador = round((sum(Saude_mental) / sum(POP_CADASTRADA_IBGE)) * 100000, 2),
      Media = round(mean(ind_Saude_mental, na.rm = TRUE), 2),
      Mediana = round(median(ind_Saude_mental, na.rm = TRUE), 2),
      Desvio_pad = round(sd(ind_Saude_mental, na.rm = TRUE), 2),
      Min = round(min(ind_Saude_mental, na.rm = TRUE), 2),
      Max = round(max(ind_Saude_mental, na.rm = TRUE), 2),
      Pvalor_shapiro = ifelse(
        sum(!is.na(ind_Saude_mental)) >= 3,
        round(tryCatch(shapiro.test(ind_Saude_mental)$p.value, error = function(e) NA), 5),
        NA
      ),
      Numerador = sum(Saude_mental),
      Denominador = sum(POP_CADASTRADA_IBGE),
      n_municip = n())%>%
      arrange(Regiao)
) %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela coluna de população cadastrada segundo o IBGE.")

```

## Dados Nacionais

```{r, echo=FALSE, warning=FALSE}
ind_temas_saude %>%
  summarise(
    Pais = 'Brasil',
    Indicador = round((sum(Saude_mental) / sum(POP_CADASTRADA_IBGE)) * 100000, 2),
    Media = round(mean(ind_saude_bucal, na.rm = TRUE), 2),
    Mediana = round(median(ind_saude_bucal, na.rm = TRUE), 2),
    Desvio_pad = round(sd(ind_saude_bucal, na.rm = TRUE), 2),
    Minimo = round(min(ind_Saude_mental, na.rm = TRUE), 2),
    Maximo = round(max(ind_Saude_mental, na.rm = TRUE), 2),
    Pvalor_shapiro = ifelse(
      sum(!is.na(ind_Saude_mental)) >= 3,
      round(tryCatch(shapiro.test(ind_Saude_mental)$p.value, error = function(e) NA), 5),
      NA
    ),
    Numerador = sum(Saude_mental),
    Denominador = sum(POP_CADASTRADA_IBGE),
    num_municip = n()
  ) %>%
  kable(
    format = "html"
  ) %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(
    general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela população cadastrada segundo o IBGE."
  )

```

## Gráficos - Saude mental

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, fig.height=4}
ggplot(ind_temas_saude,
       aes(x = ind_Saude_mental, fill = Regiao)) +
  geom_histogram(alpha = 0.5, bins = 40, position = "identity") +
  labs(x = "Prática de saúde mental por 100 mil habitantes",
     y = "Número de municípios") +
  theme_minimal()+
  theme(
    legend.position = "bottom",
    legend.box = "horizontal",
    legend.title = element_blank()
    )
```

```{r, echo=FALSE, fig.width=6, fig.height=4}
ggplot(ind_temas_saude, aes(y = ind_Saude_mental, fill = Regiao)) +
geom_boxplot() +
labs(
  title = "Indicador Saúde mental - Por Regiões", 
  subtitle = "Ano: 2023", 
  caption = "Fonte: Ministério da Saúde"
) +
theme_bw() +
theme(
  plot.title = element_text(size = 12, face = "bold"),
  plot.subtitle = element_text(size = 10),
  legend.position = "bottom",
  legend.title = element_blank()

)
```

# 5.3 Indicadores de Alimentação saudável {.tabset}

## Dados por UF

```{r, echo=FALSE, warning=FALSE}

kable(ind_temas_saude%>%
  group_by(UF) %>%
  summarise(Regiao = first(Regiao),
    Indicador = round((sum(Aliment_saudav) / sum(POP_CADASTRADA_IBGE))*100000,2),
    Media = round(mean(ind_Aliment_saudav, na.rm = TRUE),2),
    Mediana = round(median(ind_Aliment_saudav, na.rm = TRUE),2),
    Desvio_pad = round(sd(ind_Aliment_saudav, na.rm = TRUE),2),
    Minimo = round(min(ind_Aliment_saudav, na.rm = TRUE),2),
    Maximo = round(max(ind_Aliment_saudav, na.rm = TRUE),2),
    Pvalor_shapiro = ifelse(sum(!is.na(ind_Aliment_saudav)) >= 3,
      round(tryCatch(shapiro.test(ind_Aliment_saudav)$p.value, error = function(e) NA), 5),NA),
    Numerador = sum(Aliment_saudav),
    Denominador = sum(POP_CADASTRADA_IBGE),
    num_municip = n())%>%
  arrange(Regiao, UF)) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"), font_size = 10)%>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de praticas adotadas (por UF, Regiao ou país) pela coluna de total de população cadastrada no IBGE.")

```

## Dados por Regiao

```{r, echo=FALSE, warning=FALSE}

kable(
  ind_temas_saude %>%
    group_by(Regiao) %>%
    summarise(
      Indicador = round((sum(Aliment_saudav) / sum(POP_CADASTRADA_IBGE)) * 100000, 2),
      Media = round(mean(ind_Aliment_saudav, na.rm = TRUE), 2),
      Mediana = round(median(ind_Aliment_saudav, na.rm = TRUE), 2),
      Desvio_pad = round(sd(ind_Aliment_saudav, na.rm = TRUE), 2),
      Min = round(min(ind_Aliment_saudav, na.rm = TRUE), 2),
      Max = round(max(ind_Aliment_saudav, na.rm = TRUE), 2),
      Pvalor_shapiro = ifelse(
        sum(!is.na(ind_Aliment_saudav)) >= 3,
        round(tryCatch(shapiro.test(ind_Aliment_saudav)$p.value, error = function(e) NA), 5),
        NA
      ),
      Numerador = sum(Aliment_saudav),
      Denominador = sum(POP_CADASTRADA_IBGE),
      num_municip = n()
      ) %>%
    arrange(Regiao)
) %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela coluna de população cadastrada segundo o IBGE.")

```

## Dados Nacionais

```{r, echo=FALSE, warning=FALSE}
ind_temas_saude %>%
  summarise(
    Pais = 'Brasil',
    Indicador = round((sum(Aliment_saudav) / sum(POP_CADASTRADA_IBGE)) * 100000, 2),
    Media = round(mean(ind_Aliment_saudav, na.rm = TRUE), 2),
    Mediana = round(median(ind_Aliment_saudav, na.rm = TRUE), 2),
    Desvio_pad = round(sd(ind_Aliment_saudav, na.rm = TRUE), 2),
    Min = round(min(ind_Aliment_saudav, na.rm = TRUE), 2),
    Max = round(max(ind_Aliment_saudav, na.rm = TRUE), 2),
    Pvalor_shapiro = ifelse(
      sum(!is.na(ind_Aliment_saudav)) >= 3,
      round(tryCatch(shapiro.test(ind_Aliment_saudav)$p.value, error = function(e) NA), 5),
      NA
    ),
    Numerador = sum(Aliment_saudav),
    Denominador = sum(POP_CADASTRADA_IBGE),
    num_municip = n()
  ) %>%
  kable(
    format = "html"
  ) %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(
    general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela população cadastrada segundo o IBGE."
  )

```

## Gráficos

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, fig.height=4}
ggplot(ind_temas_saude,
       aes(x = ind_Aliment_saudav, fill = Regiao)) +
  geom_histogram(alpha = 0.5, bins = 40, position = "identity") +
  labs(x = "Prática de Alimentação saudável por 100 mil habitantes",
     y = "Número de municípios") +
  theme_minimal()+
  theme(
    legend.position = "bottom",
    legend.box = "horizontal",
    legend.title = element_blank()
    )
```

```{r, echo=FALSE, fig.width=6, fig.height=4}
ggplot(ind_temas_saude, aes(y = ind_Aliment_saudav, fill = Regiao)) +
geom_boxplot() +
labs(
  title = "Indicador Alimentação saudável - Por Regiões", 
  subtitle = "Ano: 2023", 
  caption = "Fonte: Ministério da Saúde"
) +
theme_bw() +
theme(
  plot.title = element_text(size = 12, face = "bold"),
  plot.subtitle = element_text(size = 10),
  legend.position = "bottom",
  legend.title = element_blank()

)
```

# 5.4 Indicadores de práticas de saúde sexual e reprodutiva {.tabset}

## Dados por UF

```{r, echo=FALSE, warning=FALSE}

kable(ind_temas_saude%>%
  group_by(UF) %>%
  summarise(Regiao = first(Regiao),
    Indicador = round((sum(Saude_reprodut) / sum(POP_CADASTRADA_IBGE))*100000,2),
    Media = round(mean(ind_Saude_reprodut, na.rm = TRUE),2),
    Mediana = round(median(ind_Saude_reprodut, na.rm = TRUE),2),
    Desvio_pad = round(sd(ind_Saude_reprodut, na.rm = TRUE),2),
    Min = round(min(ind_Saude_reprodut, na.rm = TRUE),2),
    Max = round(max(ind_Saude_reprodut, na.rm = TRUE),2),
    Pvalor_shapiro = ifelse(sum(!is.na(ind_Saude_reprodut)) >= 3,
      round(tryCatch(shapiro.test(ind_Saude_reprodut)$p.value, error = function(e) NA), 5),NA),
    Numerador = sum(Saude_reprodut),
    Denominador = sum(POP_CADASTRADA_IBGE),
    num_municip = n())%>%
  arrange(Regiao, UF)) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"), font_size = 10)%>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de praticas adotadas (por UF, Regiao ou país) pela coluna de total de população cadastrada no IBGE.")

```

## Dados por Regiao

```{r, echo=FALSE, warning=FALSE}

kable(
  ind_temas_saude %>%
    group_by(Regiao) %>%
    summarise(
      Indicador = round((sum(Saude_reprodut) / sum(POP_CADASTRADA_IBGE)) * 100000, 2),
      Media = round(mean(ind_Saude_reprodut, na.rm = TRUE), 2),
      Mediana = round(median(ind_Saude_reprodut, na.rm = TRUE), 2),
      Desvio_pad = round(sd(ind_Saude_reprodut, na.rm = TRUE), 2),
      Min = round(min(ind_Saude_reprodut, na.rm = TRUE), 2),
      Max = round(max(ind_Saude_reprodut, na.rm = TRUE), 2),
      Pvalor_shapiro = ifelse(
        sum(!is.na(ind_Saude_reprodut)) >= 3,
        round(tryCatch(shapiro.test(ind_Saude_reprodut)$p.value, error = function(e) NA), 5),
        NA
      ),
      Numerador = sum(Saude_reprodut),
      Denominador = sum(POP_CADASTRADA_IBGE),
      num_municip = n()
    ) %>%
    arrange(Regiao)
) %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela coluna de população cadastrada segundo o IBGE.")

```

## Dados Nacionais

```{r, echo=FALSE, warning=FALSE}
ind_temas_saude %>%
  summarise(
    Pais = 'Brasil',
    Indicador = round((sum(Saude_reprodut) / sum(POP_CADASTRADA_IBGE)) * 100000, 2),
    Media = round(mean(ind_Saude_reprodut, na.rm = TRUE), 2),
    Mediana = round(median(ind_Saude_reprodut, na.rm = TRUE), 2),
    Desvio_pad = round(sd(ind_Saude_reprodut, na.rm = TRUE), 2),
    Min = round(min(ind_Saude_reprodut, na.rm = TRUE), 2),
    Max = round(max(ind_Saude_reprodut, na.rm = TRUE), 2),
    pvalor_shapiro = ifelse(
      sum(!is.na(ind_Saude_reprodut)) >= 3,
      round(tryCatch(shapiro.test(ind_Saude_reprodut)$p.value, error = function(e) NA), 5),
      NA
    ),
    Numerador = sum(Saude_reprodut),
    Denominador = sum(POP_CADASTRADA_IBGE),
    num_municip = n()
  ) %>%
  kable(
    format = "html"
  ) %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(
    general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela população cadastrada segundo o IBGE."
  )

```

## Gráficos

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, fig.height=4}
ggplot(ind_temas_saude,
       aes(x = ind_Saude_reprodut, fill = Regiao)) +
  geom_histogram(alpha = 0.5, bins = 40, position = "identity") +
  labs(x = "Prática de saúde reprodutiva por 100 mil habitantes",
     y = "Número de municípios") +
  theme_minimal()+
  theme(
    legend.position = "bottom",
    legend.box = "horizontal",
    legend.title = element_blank()
    )
```

```{r, echo=FALSE, fig.width=6, fig.height=4}
ggplot(ind_temas_saude, aes(y = ind_Saude_reprodut, fill = Regiao)) +
geom_boxplot() +
labs(
  title = "Indicador Saúde Reprodutiva - Por Regiões", 
  subtitle = "Ano: 2023", 
  caption = "Fonte: Ministério da Saúde"
) +
theme_bw() +
theme(
  plot.title = element_text(size = 12, face = "bold"),
  plot.subtitle = element_text(size = 10),
  legend.position = "bottom",
  legend.title = element_blank()

)
```

# 5.5 Indicadores de práticas autocuidado {.tabset}

## Dados por UF

```{r, echo=FALSE, warning=FALSE}

kable(ind_temas_saude%>%
  group_by(UF) %>%
  summarise(Regiao = first(Regiao),
    Indicador = round((sum(auto_cuid_doenc_cronic) / sum(POP_CADASTRADA_IBGE))*100000,2),
    Media = round(mean(ind_auto_cuid_doenc_cronic, na.rm = TRUE),2),
    Mediana = round(median(ind_auto_cuid_doenc_cronic, na.rm = TRUE),2),
    Desvio_pad = round(sd(ind_auto_cuid_doenc_cronic, na.rm = TRUE),2),
    Min = round(min(ind_auto_cuid_doenc_cronic, na.rm = TRUE),2),
    Max = round(max(ind_auto_cuid_doenc_cronic, na.rm = TRUE),2),
    Pvalor_shapiro = ifelse(sum(!is.na(ind_auto_cuid_doenc_cronic)) >= 3,
      round(tryCatch(shapiro.test(ind_auto_cuid_doenc_cronic)$p.value, error = function(e) NA), 5),NA),
    Numerador = sum(auto_cuid_doenc_cronic),
    Denominador = sum(POP_CADASTRADA_IBGE),
    num_municip = n())%>%
  arrange(Regiao, UF)) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"), font_size = 10)%>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de praticas adotadas (por UF, Regiao ou país) pela coluna de total de população cadastrada no IBGE.")

```

## Dados por Regiao

```{r, echo=FALSE, warning=FALSE}

kable(
  ind_temas_saude %>%
    group_by(Regiao) %>%
    summarise(
      Indicador = round((sum(auto_cuid_doenc_cronic) / sum(POP_CADASTRADA_IBGE)) * 100000, 2),
      Media = round(mean(ind_auto_cuid_doenc_cronic, na.rm = TRUE), 2),
      Mediana = round(median(ind_auto_cuid_doenc_cronic, na.rm = TRUE), 2),
      Desvio_padrao = round(sd(ind_auto_cuid_doenc_cronic, na.rm = TRUE), 2),
      Minimo = round(min(ind_auto_cuid_doenc_cronic, na.rm = TRUE), 2),
      Maximo = round(max(ind_auto_cuid_doenc_cronic, na.rm = TRUE), 2),
      Pvalor_shapiro = ifelse(
        sum(!is.na(ind_Saude_reprodut)) >= 3,
        round(tryCatch(shapiro.test(ind_auto_cuid_doenc_cronic)$p.value, error = function(e) NA), 5),
        NA
      ),
      Numerador = sum(auto_cuid_doenc_cronic),
      Denominador = sum(POP_CADASTRADA_IBGE),
      num_municip = n()
    ) %>%
    arrange(Regiao)
) %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela coluna de população cadastrada segundo o IBGE.")

```

## Dados Nacionais

```{r, echo=FALSE, warning=FALSE}
ind_temas_saude %>%
  summarise(
    Pais = 'Brasil',
    Indicador = round((sum(Saude_reprodut) / sum(POP_CADASTRADA_IBGE)) * 100000, 2),
    Media = round(mean(ind_Saude_reprodut, na.rm = TRUE), 2),
    Mediana = round(median(ind_Saude_reprodut, na.rm = TRUE), 2),
    Desvio_pad = round(sd(ind_Saude_reprodut, na.rm = TRUE), 2),
    Min = round(min(ind_Saude_reprodut, na.rm = TRUE), 2),
    Max = round(max(ind_Saude_reprodut, na.rm = TRUE), 2),
    Pvalor_shapiro = ifelse(
      sum(!is.na(ind_Saude_reprodut)) >= 3,
      round(tryCatch(shapiro.test(ind_Saude_reprodut)$p.value, error = function(e) NA), 5),
      NA
    ),
    Numerador = sum(Saude_reprodut),
    Denominador = sum(POP_CADASTRADA_IBGE),
    num_municip = n()
  ) %>%
  kable(
    format = "html"
  ) %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(
    general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela população cadastrada segundo o IBGE."
  )

```

## Gráficos

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, fig.height=4}
ggplot(ind_temas_saude,
       aes(x = ind_Saude_reprodut, fill = Regiao)) +
  geom_histogram(alpha = 0.5, bins = 40, position = "identity") +
  labs(x = "Prática de saúde reprodutiva por 100 mil habitantes",
     y = "Número de municípios") +
  theme_minimal()+
  theme(
    legend.position = "bottom",
    legend.box = "horizontal",
    legend.title = element_blank()
    )
```

```{r, echo=FALSE, fig.width=6, fig.height=4}
ggplot(ind_temas_saude, aes(y = ind_Saude_reprodut, fill = Regiao)) +
geom_boxplot() +
labs(
  title = "Indicador Saúde reprodutiva - Por Regiões", 
  subtitle = "Ano: 2023", 
  caption = "Fonte: Ministério da Saúde"
) +
theme_bw() +
theme(
  plot.title = element_text(size = 12, face = "bold"),
  plot.subtitle = element_text(size = 10),
  legend.position = "bottom",
  legend.title = element_blank()

)
```

# 5.6 Indicadores de Práticas de saúde corporais/atividade física {.tabset}

## Dados por UF

```{r, echo=FALSE, warning=FALSE}

kable(ind_praticas_saude%>%
  group_by(UF) %>%
  summarise(Regiao = first(Regiao),
    Indicador = round((sum(Praticas_atividades_corporais) / sum(POP_CADASTRADA_IBGE))*100000,2),
    Media = round(mean(ind_Praticas_atividades_corporais, na.rm = TRUE),2),
    Mediana = round(median(ind_Praticas_atividades_corporais, na.rm = TRUE),2),
    Desvio_pad = round(sd(ind_Praticas_atividades_corporais, na.rm = TRUE),2),
    Min = round(min(ind_Praticas_atividades_corporais, na.rm = TRUE),2),
    Max = round(max(ind_Praticas_atividades_corporais, na.rm = TRUE),2),
    Pvalor_shapiro = ifelse(sum(!is.na(ind_Praticas_atividades_corporais)) >= 3,
      round(tryCatch(shapiro.test(ind_Praticas_atividades_corporais)$p.value, error = function(e) NA), 5),NA),
    Numerador = sum(Praticas_atividades_corporais),
    Denominador = sum(POP_CADASTRADA_IBGE),
    num_municip = n())%>%
  arrange(Regiao, UF)) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"), font_size = 10)%>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de praticas adotadas (por UF, Regiao ou país) pela coluna de total de população cadastrada no IBGE.")

```

## Dados por Regiao

```{r, echo=FALSE, warning=FALSE}

kable(
  ind_praticas_saude %>%
    group_by(Regiao) %>%
    summarise(
      indicador = round((sum(Praticas_atividades_corporais) / sum(POP_CADASTRADA_IBGE)) * 100000, 2),
      Media = round(mean(ind_Praticas_atividades_corporais, na.rm = TRUE), 2),
      Mediana = round(median(ind_Praticas_atividades_corporais, na.rm = TRUE), 2),
      Desvio_pad = round(sd(ind_Praticas_atividades_corporais, na.rm = TRUE), 2),
      Minimo = round(min(ind_Praticas_atividades_corporais, na.rm = TRUE), 2),
      Maximo = round(max(ind_Praticas_atividades_corporais, na.rm = TRUE), 2),
      Pvalor_shapiro = ifelse(
        sum(!is.na(ind_Praticas_atividades_corporais)) >= 3,
        round(tryCatch(shapiro.test(ind_Praticas_atividades_corporais)$p.value, error = function(e) NA), 5),
        NA
      ),
      Numerador = sum(Praticas_atividades_corporais),
      Denominador = sum(POP_CADASTRADA_IBGE),
      num_municip = n()
    ) %>%
    arrange(Regiao)
) %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela coluna de população cadastrada segundo o IBGE.")

```

## Dados Nacionais

```{r, echo=FALSE, warning=FALSE}
ind_praticas_saude %>%
  summarise(
    Pais = 'Brasil',
    Indicador = round((sum(Praticas_atividades_corporais) / sum(POP_CADASTRADA_IBGE)) * 100000, 2),
    Media = round(mean(ind_Praticas_atividades_corporais, na.rm = TRUE), 2),
    Mediana = round(median(ind_Praticas_atividades_corporais, na.rm = TRUE), 2),
    Desvio_pad = round(sd(ind_Praticas_atividades_corporais, na.rm = TRUE), 2),
    Min = round(min(ind_Praticas_atividades_corporais, na.rm = TRUE), 2),
    Max = round(max(ind_Praticas_atividades_corporais, na.rm = TRUE), 2),
    Pvalor_shapiro = ifelse(
      sum(!is.na(ind_Praticas_atividades_corporais)) >= 3,
      round(tryCatch(shapiro.test(ind_Praticas_atividades_corporais)$p.value, error = function(e) NA), 5),
      NA
    ),
    Numerador = sum(Praticas_atividades_corporais),
    Denominador = sum(POP_CADASTRADA_IBGE),
    num_municip = n()
  ) %>%
  kable(
    format = "html"
  ) %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(
    general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela população cadastrada segundo o IBGE."
  )

```

## Gráficos

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, fig.height=4}
ggplot(ind_praticas_saude,
       aes(x = ind_Praticas_atividades_corporais, fill = Regiao)) +
  geom_histogram(alpha = 0.5, bins = 40, position = "identity") +
  labs(x = "Indicador de práticas de atividade corporal por 100 mil habitantes",
     y = "Número de municípios") +
  theme_minimal()+
  theme(
    legend.position = "bottom",
    legend.box = "horizontal",
    legend.title = element_blank()
    )
```

```{r, echo=FALSE, fig.width=6, fig.height=4}
ggplot(ind_praticas_saude, aes(y = ind_Praticas_atividades_corporais, fill = Regiao)) +
geom_boxplot() +
labs(
  title = "Indicador de práticas de atividade corporal - Por Regiões", 
  subtitle = "Ano: 2023", 
  caption = "Fonte: Ministério da Saúde"
) +
theme_bw() +
theme(
  plot.title = element_text(size = 12, face = "bold"),
  plot.subtitle = element_text(size = 10),
  legend.position = "bottom",
  legend.title = element_blank()

)
```

# 5.7 Indicadores de Práticas de saúde Verificação de situação vacinal {.tabset}

## Dados por UF

```{r, echo=FALSE, warning=FALSE}

kable(ind_praticas_saude%>%
  group_by(UF) %>%
  summarise(Regiao = first(Regiao),
    Indicador = round((sum(Verific_sit_vacina) / sum(POP_CADASTRADA_IBGE))*100000,2),
    Media = round(mean(ind_Verific_sit_vacina, na.rm = TRUE),2),
    Mediana = round(median(ind_Verific_sit_vacina, na.rm = TRUE),2),
    Desvio_pad = round(sd(ind_Verific_sit_vacina, na.rm = TRUE),2),
    Min = round(min(ind_Verific_sit_vacina, na.rm = TRUE),2),
    Max = round(max(ind_Verific_sit_vacina, na.rm = TRUE),2),
    Pvalor_shapiro = ifelse(sum(!is.na(ind_Verific_sit_vacina)) >= 3,
      round(tryCatch(shapiro.test(ind_Verific_sit_vacina)$p.value, error = function(e) NA), 5),NA),
    Numerador = sum(Verific_sit_vacina),
    Denominador = sum(POP_CADASTRADA_IBGE),
    num_municip = n())%>%
  arrange(Regiao, UF)) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"), font_size = 10)%>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de praticas adotadas (por UF, Regiao ou país) pela coluna de total de população cadastrada no IBGE.")

```

## Dados por Regiao

```{r, echo=FALSE, warning=FALSE}

kable(
  ind_praticas_saude %>%
    group_by(Regiao) %>%
    summarise(
      indicador = round((sum(Verific_sit_vacina) / sum(POP_CADASTRADA_IBGE)) * 100000, 2),
      Media = round(mean(ind_Verific_sit_vacina, na.rm = TRUE), 2),
      Mediana = round(median(ind_Verific_sit_vacina, na.rm = TRUE), 2),
      Desvio_pad = round(sd(ind_Verific_sit_vacina, na.rm = TRUE), 2),
      Minimo = round(min(ind_Verific_sit_vacina, na.rm = TRUE), 2),
      Maximo = round(max(ind_Verific_sit_vacina, na.rm = TRUE), 2),
      Pvalor_shapiro = ifelse(
        sum(!is.na(ind_Verific_sit_vacina)) >= 3,
        round(tryCatch(shapiro.test(ind_Verific_sit_vacina)$p.value, error = function(e) NA), 5),
        NA
      ),
      Numerador = sum(Verific_sit_vacina),
      Denominador = sum(POP_CADASTRADA_IBGE),
      num_municip = n()
    ) %>%
    arrange(Regiao)
) %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela coluna de população cadastrada segundo o IBGE.")

```

## Dados Nacionais

```{r, echo=FALSE, warning=FALSE}
ind_praticas_saude %>%
  summarise(
    Pais = 'Brasil',
    Indicador = round((sum(Verific_sit_vacina) / sum(POP_CADASTRADA_IBGE)) * 100000, 2),
    Media = round(mean(ind_Verific_sit_vacina, na.rm = TRUE), 2),
    Mediana = round(median(ind_Verific_sit_vacina, na.rm = TRUE), 2),
    Desvio_pad = round(sd(ind_Verific_sit_vacina, na.rm = TRUE), 2),
    Min = round(min(ind_Verific_sit_vacina, na.rm = TRUE), 2),
    Max = round(max(ind_Verific_sit_vacina, na.rm = TRUE), 2),
    Pvalor_shapiro = ifelse(
      sum(!is.na(ind_Verific_sit_vacina)) >= 3,
      round(tryCatch(shapiro.test(ind_Verific_sit_vacina)$p.value, error = function(e) NA), 5),
      NA
    ),
    Numerador = sum(Verific_sit_vacina),
    Denominador = sum(POP_CADASTRADA_IBGE),
    num_municip = n()
  ) %>%
  kable(
    format = "html"
  ) %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(
    general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela população cadastrada segundo o IBGE."
  )

```

## Gráficos

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, fig.height=4}
ggplot(ind_praticas_saude,
       aes(x = ind_Verific_sit_vacina, fill = Regiao)) +
  geom_histogram(alpha = 0.5, bins = 40, position = "identity") +
  labs(x = "Indice de Situação vacinal por 100 mil habitantes",
     y = "Número de municípios") +
  theme_minimal()+
  theme(
    legend.position = "bottom",
    legend.box = "horizontal",
    legend.title = element_blank()
    )
```

```{r, echo=FALSE, fig.width=6, fig.height=4}
ggplot(ind_praticas_saude, aes(y = ind_Verific_sit_vacina, fill = Regiao)) +
geom_boxplot() +
labs(
  title = "Indicador situação vacinal - Por Regiões", 
  subtitle = "Ano: 2023", 
  caption = "Fonte: Ministério da Saúde"
) +
theme_bw() +
theme(
  plot.title = element_text(size = 12, face = "bold"),
  plot.subtitle = element_text(size = 10),
  legend.position = "bottom",
  legend.title = element_blank()

)
```

# 5.8 Verificação de saúde Vacinal {.tabset}

## Dados por UF

```{r, echo=FALSE, warning=FALSE}

kable(ind_praticas_saude%>%
  group_by(UF) %>%
  summarise(Regiao = first(Regiao),
    Indicador = round((sum(Verific_sit_vacina) / sum(POP_CADASTRADA_IBGE))*100000,2),
    Media = round(mean(ind_Verific_sit_vacina, na.rm = TRUE),2),
    Mediana = round(median(ind_Verific_sit_vacina, na.rm = TRUE),2),
    Desvio_pad = round(sd(ind_Verific_sit_vacina, na.rm = TRUE),2),
    Minimo = round(min(ind_Verific_sit_vacina, na.rm = TRUE),2),
    Maximo = round(max(ind_Verific_sit_vacina, na.rm = TRUE),2),
    Pvalor_shapiro = ifelse(sum(!is.na(ind_Verific_sit_vacina)) >= 3,
      round(tryCatch(shapiro.test(ind_Verific_sit_vacina)$p.value, error = function(e) NA), 5),NA),
    Numerador = sum(Verific_sit_vacina),
    Denominador = sum(POP_CADASTRADA_IBGE),
    num_municip = n())%>%
  arrange(Regiao, UF)) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"), font_size = 10)%>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de praticas adotadas (por UF, Regiao ou país) pela coluna de total de população cadastrada no IBGE.")

```

## Dados por Regiao

```{r, echo=FALSE, warning=FALSE}

kable(
  ind_praticas_saude %>%
    group_by(Regiao) %>%
    summarise(
      Indicador = round((sum(Verific_sit_vacina) / sum(POP_CADASTRADA_IBGE)) * 100000, 2),
      Media = round(mean(Verific_sit_vacina, na.rm = TRUE), 2),
      Mediana = round(median(ind_Verific_sit_vacina, na.rm = TRUE), 2),
      Desvio_padrao = round(sd(ind_Verific_sit_vacina, na.rm = TRUE), 2),
      Minimo = round(min(ind_Verific_sit_vacina, na.rm = TRUE), 2),
      Maximo = round(max(ind_Verific_sit_vacina, na.rm = TRUE), 2),
      Pvalor_shapiro = ifelse(
        sum(!is.na(ind_Verific_sit_vacina)) >= 3,
        round(tryCatch(shapiro.test(ind_Verific_sit_vacina)$p.value, error = function(e) NA), 5),
        NA
      ),
      numerador = sum(Verific_sit_vacina),
      Denominador = sum(POP_CADASTRADA_IBGE),
      num_municip = n()
    ) %>%
    arrange(Regiao)
) %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela coluna de população cadastrada segundo o IBGE.")

```

## Dados Nacionais

```{r, echo=FALSE, warning=FALSE}
ind_praticas_saude %>%
  summarise(
    Pais = 'Brasil',
    Indicador = round((sum(Verific_sit_vacina) / sum(POP_CADASTRADA_IBGE)) * 100000, 2),
    Media = round(mean(ind_Verific_sit_vacina, na.rm = TRUE), 2),
    Mediana = round(median(ind_Verific_sit_vacina, na.rm = TRUE), 2),
    Desvio_padrao = round(sd(ind_Verific_sit_vacina, na.rm = TRUE), 2),
    Minimo = round(min(ind_Verific_sit_vacina, na.rm = TRUE), 2),
    Maximo = round(max(ind_Verific_sit_vacina, na.rm = TRUE), 2),
    Pvalor_shapiro = ifelse(
      sum(!is.na(ind_Verific_sit_vacina)) >= 3,
      round(tryCatch(shapiro.test(ind_Verific_sit_vacina)$p.value, error = function(e) NA), 5),
      NA
    ),
    Numerador = sum(Verific_sit_vacina), 
    Denominador = sum (POP_CADASTRADA_IBGE),
    n_municip = n()
  ) %>%
  kable(
    format = "html"
  ) %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(
    general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela população cadastrada segundo o IBGE."
  )

```

## Gráficos

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, fig.height=4}
ggplot(ind_praticas_saude,
       aes(x = ind_Verific_sit_vacina, fill = Regiao)) +
  geom_histogram(alpha = 0.5, bins = 40, position = "identity") +
  labs(x = "Prática de saúde mental por 100 mil habitantes",
     y = "Número de municípios") +
  theme_minimal()+
  theme(
    legend.position = "bottom",
    legend.box = "horizontal",
    legend.title = element_blank()
    )
```

```{r, echo=FALSE, fig.width=6, fig.height=4}
ggplot(ind_praticas_saude, aes(y = ind_Verific_sit_vacina, fill = Regiao)) +
geom_boxplot() +
labs(
  title = "Indicador Saúde mental - Por Regiões", 
  subtitle = "Ano: 2023", 
  caption = "Fonte: Ministério da Saúde"
) +
theme_bw() +
theme(
  plot.title = element_text(size = 12, face = "bold"),
  plot.subtitle = element_text(size = 10),
  legend.position = "bottom",
  legend.title = element_blank()

)
```

# 5.9 Indicador de adesão de práticas de saude nas escolas {.tabset}

## Dados por UF

```{r, echo=FALSE, warning=FALSE}

kable(
  ind_adesão_escolas %>%
    group_by(UF) %>%
    summarise(
      Regiao = first(Regiao),
      Indicador = round(sum(Educação, na.rm = TRUE) / sum(QTD_escolas, na.rm = TRUE), 2),
      Media = round(mean(ind_Educação, na.rm = TRUE), 2),
      Mediana = round(median(ind_Educação, na.rm = TRUE), 2),
      Desvio_pad = round(sd(ind_Educação, na.rm = TRUE), 2),
      Min = round(min(ind_Educação, na.rm = TRUE), 2),
      Max = round(max(ind_Educação, na.rm = TRUE), 2),
      Pvalor_shapiro = ifelse(
        sum(!is.na(ind_Educação)) >= 3,
        round(tryCatch(shapiro.test(ind_Educação)$p.value, error = function(e) NA), 5),
        NA
      ),
      Numerador = sum(Educação),
      Denominador = sum(QTD_escolas)
    ) %>%
    arrange(Regiao, UF)
) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"), font_size = 10) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela coluna de total de população cadastrada no IBGE.")

```

## Dados por Regiao

```{r, echo=FALSE, warning=FALSE}

kable(
  ind_adesão_escolas %>%
    group_by(Regiao) %>%
    summarise(
      Indicador = round(sum(Educação, na.rm = TRUE) / sum(QTD_escolas, na.rm = TRUE), 2),
      Media = round(mean(ind_Educação, na.rm = TRUE), 2),
      Mediana = round(median(ind_Educação, na.rm = TRUE), 2),
      Desvio_pad = round(sd(ind_Educação, na.rm = TRUE), 2),
      Min = round(min(ind_Educação, na.rm = TRUE), 2),
      Max = round(max(ind_Educação, na.rm = TRUE), 2),
      Pvalor_shapiro = ifelse(
        sum(!is.na(ind_Educação)) >= 3,
        round(tryCatch(shapiro.test(ind_Educação)$p.value, error = function(e) NA), 5),
        NA
      ),
      Numerador = sum(Educação),
      Denominador = sum(QTD_escolas)
    ) %>%
    arrange(Regiao)
) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"), font_size = 10) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela coluna de total de população cadastrada no IBGE.")

```

## Dados Nacionais

```{r, echo=FALSE, warning=FALSE}

kable(
  ind_adesão_escolas %>%
    summarise(
      País = 'Brasil', 
      Indicador = round(sum(Educação, na.rm = TRUE) / sum(QTD_escolas, na.rm = TRUE), 2),
      Media = round(mean(ind_Educação, na.rm = TRUE), 2),
      Mediana = round(median(ind_Educação, na.rm = TRUE), 2),
      Desvio_pad = round(sd(ind_Educação, na.rm = TRUE), 2),
      Min = round(min(ind_Educação, na.rm = TRUE), 2),
      Max = round(max(ind_Educação, na.rm = TRUE), 2),
      Pvalor_shapiro = ifelse(
        sum(!is.na(ind_Educação)) >= 3,
        round(tryCatch(shapiro.test(ind_Educação)$p.value, error = function(e) NA), 5),
        NA
      ),
      Numerador = sum(Educação, na.rm = TRUE),
      Denominador = sum(QTD_escolas, na.rm = TRUE)
    )
) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"), font_size = 10) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela coluna de total de população cadastrada no IBGE.")

```

## Gráficos

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, fig.height=4}
ggplot(ind_adesão_escolas,
       aes(x = ind_Educação, fill = Regiao)) +
  geom_histogram(alpha = 0.5, bins = 40, position = "identity") +
  labs(x = "Indicador Práticas de saúde nas escolas",
     y = "Número de municípios") +
  theme_minimal()+
  theme(
    legend.position = "bottom",
    legend.box = "horizontal",
    legend.title = element_blank()
    )
```

```{r, echo=FALSE, fig.width=6, fig.height=4}
ggplot(ind_adesão_escolas, aes(y = ind_Educação, fill = Regiao)) +
geom_boxplot() +
labs(
  title = "Indicador Práticas de saúde nas escolas - Por Regiões", 
  subtitle = "Ano: 2023", 
  caption = "Fonte: Ministério da Saúde"
) +
theme_bw() +
theme(
  plot.title = element_text(size = 12, face = "bold"),
  plot.subtitle = element_text(size = 10),
  legend.position = "bottom",
  legend.title = element_blank()

)
```

# 5.10 Indicador de adesão de práticas de saude nas escolas {.tabset}

## Dados por UF

```{r, echo=FALSE, warning=FALSE}

#ind_adesão_escolas$ind_Saúde

kable(
  ind_adesão_escolas %>%
    group_by(UF) %>%
    summarise(
      Regiao = first(Regiao),
      Indicador = round(sum(Saúde, na.rm = TRUE) / sum(QTD_escolas, na.rm = TRUE), 2),
      Media = round(mean(ind_Saúde, na.rm = TRUE), 2),
      Mediana = round(median(ind_Saúde, na.rm = TRUE), 2),
      Desvio_pad = round(sd(ind_Saúde, na.rm = TRUE), 2),
      Min = round(min(ind_Saúde, na.rm = TRUE), 2),
      Max = round(max(ind_Saúde, na.rm = TRUE), 2),
      Pvalor_shapiro = ifelse(
        sum(!is.na(ind_Saúde)) >= 3,
        round(tryCatch(shapiro.test(ind_Saúde)$p.value, error = function(e) NA), 5),
        NA
      ), 
      Numerador = sum(Saúde),
      Denominador = sum(QTD_escolas)
    ) %>%
    arrange(Regiao, UF)
) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"), font_size = 10) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela coluna de total de população cadastrada no IBGE.")

```

## Dados por Regiao

```{r, echo=FALSE, warning=FALSE}

kable(
  ind_adesão_escolas %>%
    group_by(Regiao) %>%
    summarise(
      Indicador = round(sum(Saúde, na.rm = TRUE) / sum(QTD_escolas, na.rm = TRUE), 2),
      Media = round(mean(ind_Saúde, na.rm = TRUE), 2),
      Mediana = round(median(ind_Saúde, na.rm = TRUE), 2),
      Desvio_pad = round(sd(ind_Saúde, na.rm = TRUE), 2),
      Min = round(min(ind_Saúde, na.rm = TRUE), 2),
      Max = round(max(ind_Saúde, na.rm = TRUE), 2),
      Pvalor_shapiro = ifelse(
        sum(!is.na(ind_Saúde)) >= 3,
        round(tryCatch(shapiro.test(ind_Saúde)$p.value, error = function(e) NA), 5),
        NA
      ), 
      Numerador = sum(Saúde),
      Denominador = sum(QTD_escolas)
    ) %>%
    arrange(Regiao)
) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"), font_size = 10) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela coluna de total de população cadastrada no IBGE.")

```

## Dados Nacionais

```{r, echo=FALSE, warning=FALSE}

kable(
  ind_adesão_escolas %>%
    summarise(País = 'Brasil', 
      Indicador = round(sum(Saúde, na.rm = TRUE) / sum(QTD_escolas, na.rm = TRUE), 2),
      Media = round(mean(ind_Saúde, na.rm = TRUE), 2),
      Mediana = round(median(ind_Saúde, na.rm = TRUE), 2),
      Desvio_pad = round(sd(ind_Saúde, na.rm = TRUE), 2),
      Min = round(min(ind_Saúde, na.rm = TRUE), 2),
      Max = round(max(ind_Saúde, na.rm = TRUE), 2),
      Pvalor_shapiro = ifelse(
        sum(!is.na(ind_Saúde)) >= 3,
        round(tryCatch(shapiro.test(ind_Saúde)$p.value, error = function(e) NA), 5),
        NA
      ), 
      Numerador = sum(Saúde),
      Denominador = sum(QTD_escolas))) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"), font_size = 10) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  footnote(general = "*A coluna indicador foi calculada pela divisão do total de práticas adotadas (por UF, Regiao ou país) pela coluna de total de população cadastrada no IBGE.")

```

## Gráficos

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, fig.height=4}
ggplot(ind_adesão_escolas,
       aes(x = ind_Saúde, fill = Regiao)) +
  geom_histogram(alpha = 0.5, bins = 40, position = "identity") +
  labs(x = "Indicador Práticas de saúde nas escolas",
     y = "Número de municípios") +
  theme_minimal()+
  theme(
    legend.position = "bottom",
    legend.box = "horizontal",
    legend.title = element_blank()
    )
```

```{r, echo=FALSE, fig.width=6, fig.height=4}
ggplot(ind_adesão_escolas, aes(y = ind_Saúde, fill = Regiao)) +
geom_boxplot() +
labs(
  title = "Indicador Práticas de saúde nas escolas - Por Regiões", 
  subtitle = "Ano: 2023", 
  caption = "Fonte: Ministério da Saúde"
) +
theme_bw() +
theme(
  plot.title = element_text(size = 12, face = "bold"),
  plot.subtitle = element_text(size = 10),
  legend.position = "bottom",
  legend.title = element_blank()

)
```

# 5.11 Indicadores Bolsa Família {.tabset}

::: {style="text-align: justify; text-indent: 2em;"}
Os dados evidenciam uma baixa dispersão (coeficiente de variação máximo de 18% por UF) e constatou-se uma forte concentração percentuais de cobertura em torno da média (83%), indicando que a maioria dos municípios consegue atingir patamares elevados de cobertura. No entanto, apesar da homogeneidade de dados constatada, verificou-se a presença de outliers na série.
:::

::: {style="text-align: justify; text-indent: 2em;"}
Em relação aos percentuais de cobertura no âmbito regional, verifica-se que os estados da Regiao nordeste apresentaram os melhores resultados. No entanto, apesar dos patamares elevados de cobertura, os resultados identificados na Regiao Norte (estados de Amapá e Roraima) indicam a necessidade de aprimoramento em seus processos para uma evolução em seus percentuais. Na instância estadual, constata-se que os resultados apresentados na Regiao Sudeste apresentaram maior amplitude (mínimo de 22% e o máximo de 100%), refletindo assim em uma maior volatilidade (desvio padrão de 13% para a Regiao), indicando uma maior desigualdade nos processos de acompanhamento dos beneficiários.
:::

::: {style="text-align: justify; text-indent: 2em;"}
No que diz respeito a premissa de normalidade da série, devido a característica da taxa percentual adotada (com valores entre 0 e 1 e com forte concentração assimétrica em valores próximos a 1), os testes estatísticos adotados por Regiao e as características do histograma indicam a não normalidade da série quando avalia-se os dados de forma global.
:::

::: {style="text-align: justify; text-indent: 2em;"}
No entanto, avaliando de forma individualizada, verifica-se que para os estados do Acre, Amazonas, Amapá e Pará, constata-se não se rejeita a hipótese de normalidade, indicando a necessidade de uma avaliação mais específica para estes estados ou para a Regiao norte como um todo, conforme pode ser verificado na tabela abaixo:
:::

## Dados por UF

```{r, echo=FALSE, warning=FALSE}
Bolsa_familia_2023 %>%
  group_by(UF_SIGLA) %>%
  summarise(
    media = percent(mean(perc_cob_ben_acomp, na.rm = TRUE), accuracy = 0.1),
    mediana = percent(median(perc_cob_ben_acomp, na.rm = TRUE), accuracy = 0.1),
    sd = percent(sd(perc_cob_ben_acomp, na.rm = TRUE), accuracy = 0.1),
    min = percent(min(perc_cob_ben_acomp, na.rm = TRUE), accuracy = 0.1),
    max = percent(max(perc_cob_ben_acomp, na.rm = TRUE), accuracy = 0.1),
    pvalor_shapiro = ifelse(
      sum(!is.na(perc_cob_ben_acomp)) >= 3,
      round(tryCatch(shapiro.test(perc_cob_ben_acomp)$p.value, error = function(e) NA), 5),
      NA
    ),
    n_municipios = n()
  ) %>%
  kable(format = "html") %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2")
```

## Dados por Regiao

```{r, echo=FALSE, warning=FALSE}
Bolsa_familia_2023 %>%
  group_by(Regiao) %>%
  summarise(
    media = percent(mean(perc_cob_ben_acomp, na.rm = TRUE), accuracy = 0.1),
    mediana = percent(median(perc_cob_ben_acomp, na.rm = TRUE), accuracy = 0.1),
    sd = percent(sd(perc_cob_ben_acomp, na.rm = TRUE), accuracy = 0.1),
    min = percent(min(perc_cob_ben_acomp, na.rm = TRUE), accuracy = 0.1),
    max = percent(max(perc_cob_ben_acomp, na.rm = TRUE), accuracy = 0.1),
    pvalor_shapiro = ifelse(
      sum(!is.na(perc_cob_ben_acomp)) >= 3,
      round(tryCatch(shapiro.test(perc_cob_ben_acomp)$p.value, error = function(e) NA), 5),
      NA
    ),
    n_municipios = n()
  ) %>%
  kable(format = "html") %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2")
```

## Dados Nacionais

```{r, echo=FALSE, warning=FALSE}
Bolsa_familia_2023 %>%
  summarise(País = 'Brasil',
    media = percent(mean(perc_cob_ben_acomp, na.rm = TRUE), accuracy = 0.1),
    mediana = percent(median(perc_cob_ben_acomp, na.rm = TRUE), accuracy = 0.1),
    sd = percent(sd(perc_cob_ben_acomp, na.rm = TRUE), accuracy = 0.1),
    min = percent(min(perc_cob_ben_acomp, na.rm = TRUE), accuracy = 0.1),
    max = percent(max(perc_cob_ben_acomp, na.rm = TRUE), accuracy = 0.1),
    pvalor_shapiro = ifelse(
      sum(!is.na(perc_cob_ben_acomp)) >= 3,
      round(tryCatch(shapiro.test(perc_cob_ben_acomp)$p.value, error = function(e) NA), 5),
      NA
    ),
    n_municipios = n()
  ) %>%
  kable(format = "html") %>%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover", "condensed"),
    font_size = 10
  ) %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2")
```

## Gráficos

```{r, echo=FALSE, fig.width=6, fig.height=4}

ggplot(Bolsa_familia_2023, 
    aes(x = Regiao, 
       y = perc_cob_ben_acomp, 
       fill = Regiao)) +
    geom_boxplot(
    alpha = 0.7,                # Transparência
    width = 0.6,                # Largura dos boxes
    outlier.shape = 21,         # Formato dos outliers
    outlier.color = "black",     # Cor dos outliers
    outlier.fill = "red",        # Preenchimento dos outliers
    outlier.size = 2            # Tamanho dos outliers
    ) +
    scale_y_continuous(
    labels = label_percent(scale = 100),  # Formato percentual
    limits = c(0, 1)                     # Limites de 0% a 100%
    ) +
    labs(
    y = "% - Cobertura e Acompanhamento",
    x = ""
    ) +
    scale_fill_brewer(palette = "Set2") +  
    theme_minimal() +
    theme(
    legend.position = "none",             
    plot.title = element_text(hjust = 0.5, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5),
    axis.text.x = element_text(angle = 0, hjust = 0.5)
    )

```

```{r, warning=FALSE, echo=FALSE, fig.width=6, fig.height=4}

ggplot(Bolsa_familia_2023, 
      aes(x = perc_cob_ben_acomp, fill = Regiao)) +
      geom_histogram(
      aes(y = after_stat(count)),  # Contagem de municípios (não densidade)
      position = "identity",      # Empilha as barras (ou use "dodge" para lado a lado)
      alpha = 0.7,                # Transparência para sobreposição
      binwidth = 0.05,            # Largura dos intervalos (ajuste conforme necessário)
      color = "white",            # Cor da borda das barras
      size = 0.3                  # Espessura da borda
      ) +
      scale_x_continuous(
      labels = label_percent(scale = 100),  # Converte para percentual
      limits = c(0, 1)                   # Garante que o eixo x vá de 0% a 100%
      ) +
      labs(
      x = "Percentual de Cobertura/Acompanhamento",
      y = "Número de Municípios",
      ) +
      theme_minimal() +
      theme(
      legend.position = "bottom",
      legend.box = "horizontal",
      legend.title = element_blank(),
      plot.title = element_text(hjust = 0.5, face = "bold"),
      plot.subtitle = element_text(hjust = 0.5)
      )

```
